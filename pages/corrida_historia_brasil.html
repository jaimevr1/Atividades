<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corrida da Hist√≥ria do Brasil</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Comic+Sans+MS:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../js/playlist.js"></script>

    <style>
        @font-face {
          font-family: 'OpenDyslexic';
          src: url('../media/fonts/OpenDyslexic-Regular.otf') format('opentype');
          font-weight: normal; font-style: normal;
        }
        @font-face {
          font-family: 'OpenDyslexic';
          src: url('../media/fonts/OpenDyslexic-Bold.otf') format('opentype');
          font-weight: bold; font-style: normal;
        }
        body { font-family: 'Comic Sans MS', cursive, sans-serif; }
        .font-dyslexic { font-family: 'OpenDyslexic', 'Comic Sans MS', cursive, sans-serif; }
        .pulse-animation { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        

        const MusicPlayer = () => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(() => localStorage.getItem('musicIsPlaying') === 'true');
            const [currentTrackIndex, setCurrentTrackIndex] = useState(() => parseInt(localStorage.getItem('musicTrackIndex'), 10) || 0);

            useEffect(() => {
                localStorage.setItem('musicIsPlaying', isPlaying);
                if (isPlaying) {
                    audioRef.current.play().catch(e => console.error("Erro ao tocar m√∫sica:", e));
                } else {
                    audioRef.current.pause();
                }
            }, [isPlaying]);

            useEffect(() => {
                localStorage.setItem('musicTrackIndex', currentTrackIndex);
                if (audioRef.current) {
                    audioRef.current.src = backgroundMusicPlaylist[currentTrackIndex];
                    if (isPlaying) {
                        audioRef.current.play().catch(e => console.error("Erro ao tocar m√∫sica:", e));
                    }
                }
            }, [currentTrackIndex]);

            const handleNextTrack = () => {
                setCurrentTrackIndex(prevIndex => (prevIndex + 1) % backgroundMusicPlaylist.length);
            };

            const handleAudioEnded = () => {
                handleNextTrack();
            };

            useEffect(() => {
                const audio = audioRef.current;
                audio.volume = 0.5;
                audio.addEventListener('ended', handleAudioEnded);
                return () => {
                    audio.removeEventListener('ended', handleAudioEnded);
                };
            }, []);

            return (
                <div className="fixed bottom-4 right-4 bg-white/20 backdrop-blur-md text-white p-3 rounded-full shadow-lg flex items-center gap-3 z-50">
                    <audio ref={audioRef} src={backgroundMusicPlaylist[currentTrackIndex]} />
                    <button onClick={() => setIsPlaying(!isPlaying)} className="w-12 h-12 rounded-full bg-white/30 hover:bg-white/50 transition-all flex items-center justify-center">
                        {isPlaying ? '‚ùö‚ùö' : '‚ñ∂'}
                    </button>
                    <button onClick={handleNextTrack} className="w-12 h-12 rounded-full bg-white/30 hover:bg-white/50 transition-all flex items-center justify-center">
                        {'‚è≠'}
                    </button>
                </div>
            );
        };

        const activityConfig = {
            title: "Corrida da Hist√≥ria do Brasil",
            subject: "historia",
            activity: "corrida_historia",
            emoji: "üèÉ‚Äç‚ôÇÔ∏è",
            primaryColor: "blue",
        };

        const activityBlocks = [
            {
                id: 1,
                title: "Coloniza√ß√£o e Invas√µes",
                difficulty: "Iniciante",
                emoji: "‚õµ",
                color: "from-cyan-500 to-blue-600",
                description: "Eventos da chegada dos europeus e primeiras disputas.",
                questions: [
                    { id: "evento_1", year: 1500, text: "A chegada de Pedro √Ålvares Cabral ao Brasil.", icon: "üö¢" },
                    { id: "evento_2", year: 1549, text: "A cria√ß√£o da primeira capital do Brasil, Salvador.", icon: "üèõÔ∏è" },
                    { id: "evento_3", year: 1555, text: "Os franceses tentam criar uma col√¥nia no Rio de Janeiro.", icon: "üá´üá∑" },
                    { id: "evento_4", year: 1624, text: "Os holandeses invadem e ocupam a cidade de Salvador.", icon: "üá≥üá±" },
                    { id: "evento_5", year: 1630, text: "A chegada de Maur√≠cio de Nassau, que modernizou Recife.", icon: "üëë" }
                ],
                timeline: [1500, 1549, 1555, 1624, 1630]
            },
            {
                id: 2,
                title: "Expans√£o e Minera√ß√£o",
                difficulty: "Iniciante",
                emoji: "üíé",
                color: "from-yellow-500 to-amber-600",
                description: "A busca por riquezas no interior do Brasil.",
                questions: [
                    { id: "evento_1", year: 1693, text: "A descoberta de grandes jazidas de ouro em Minas Gerais.", icon: "üí∞" },
                    { id: "evento_2", year: 1750, text: "O Tratado de Madri definiu novas fronteiras.", icon: "üìú" },
                    { id: "evento_3", year: 1789, text: "Inconfid√™ncia Mineira, uma revolta contra os impostos.", icon: "üíé" },
                    { id: "evento_4", year: 1808, text: "A fam√≠lia real portuguesa fugiu de Napole√£o e veio para o Brasil.", icon: "üëë" },
                    { id: "evento_5", year: 1815, text: "O Brasil deixou de ser col√¥nia e se tornou Reino Unido.", icon: "üè∞" }
                ],
                timeline: [1693, 1750, 1789, 1808, 1815]
            },
            {
                id: 3,
                title: "Independ√™ncia e Imp√©rio",
                difficulty: "Intermedi√°rio",
                emoji: "üì¢",
                color: "from-green-500 to-emerald-600",
                description: "O nascimento do Brasil como na√ß√£o independente.",
                questions: [
                    { id: "evento_1", year: 1822, text: "O Grito do Ipiranga! O Brasil se torna independente.", icon: "üì¢" },
                    { id: "evento_2", year: 1824, text: "O Brasil tem sua primeira Constitui√ß√£o.", icon: "üìã" },
                    { id: "evento_3", year: 1831, text: "Dom Pedro I abdicou do trono.", icon: "üëë" },
                    { id: "evento_4", year: 1840, text: "O jovem Dom Pedro II √© coroado imperador.", icon: "üë§" },
                    { id: "evento_5", year: 1850, text: "A Lei Eus√©bio de Queir√≥s proibiu o tr√°fico de escravos.", icon: "‚õìÔ∏è" }
                ],
                timeline: [1822, 1824, 1831, 1840, 1850]
            }
        ];

        const MediaManager = {
            basePath: '../media',
            getMediaPath: (blockId, questionId, type) => `${MediaManager.basePath}/audios/${activityConfig.subject}/${activityConfig.activity}/bloco_${blockId}/${questionId}.${type}`
        };

        activityBlocks.forEach(block => {
            block.questions.forEach(q => { q.audio = MediaManager.getMediaPath(block.id, q.id, 'mp3'); });
        });

        const SoundSystem = {
            play: (src) => {
                try {
                    if (window.musicPlayerSetVolume) {
                        window.musicPlayerSetVolume(0.2); // Reduce background music volume
                    }
                    const audio = new Audio(src);
                    audio.play().catch(e => {});
                    audio.onended = () => {
                        if (window.musicPlayerSetVolume) {
                            window.musicPlayerSetVolume(0.5); // Restore background music volume
                        }
                    };
                } catch (e) {}
            },
            success: () => SoundSystem.play(`../media/sons/feedback/acertos/acerto_${Math.ceil(Math.random() * 4)}.mp3`),
            error: () => SoundSystem.play(`../media/sons/feedback/erros/erro_${Math.ceil(Math.random() * 4)}.mp3`),
            click: () => SoundSystem.play('../media/sons/feedback/click.mp3')
        };

        const InitialScreen = ({ onStart, studentName, setStudentName, font, setFont }) => (
            <div className={`min-h-screen bg-gradient-to-br from-${activityConfig.primaryColor}-500 via-purple-500 to-pink-500 flex items-center justify-center p-4`}>
                <MusicPlayer />
                <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full">
                    <div className="text-center mb-8">
                        <div className="text-6xl mb-4">{activityConfig.emoji}</div>
                        <h1 className="text-3xl font-bold text-gray-800">{activityConfig.title}</h1>
                        <p className="text-gray-600">Corra contra o tempo e mostre que voc√™ conhece a hist√≥ria!</p>
                    </div>
                    <div className="space-y-6">
                        <div>
                            <label className="block text-lg font-bold text-gray-700 mb-2">üë§ Qual √© o seu nome?</label>
                            <input type="text" value={studentName} onChange={(e) => setStudentName(e.target.value)} className="w-full p-4 border-2 border-purple-300 rounded-xl text-lg text-center focus:outline-none focus:border-purple-500" placeholder="Digite seu nome aqui" />
                        </div>
                        <div className="flex items-center justify-between">
                            <span className="text-sm font-medium text-gray-700">üî§ Fonte para dislexia:</span>
                            <button onClick={() => { const newFont = font === 'Comic Sans MS' ? 'OpenDyslexic' : 'Comic Sans MS'; setFont(newFont); localStorage.setItem('selectedFont', newFont === 'OpenDyslexic' ? 'dyslexic' : 'normal'); }} className={`px-4 py-2 rounded-lg font-medium transition-all ${font === 'OpenDyslexic' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700'}`}>
                                {font === 'OpenDyslexic' ? '‚úÖ Ativada' : '‚ö™ Desativada'}
                            </button>
                        </div>
                        <button onClick={() => onStart(studentName)} disabled={!studentName.trim()} className={`w-full py-4 rounded-lg text-xl font-bold transition-all ${studentName.trim() ? `bg-gradient-to-r from-${activityConfig.primaryColor}-500 to-pink-500 text-white hover:shadow-lg` : 'bg-gray-300 text-gray-500 cursor-not-allowed'}`}>üèÅ COME√áAR CORRIDA!</button>
                        <a href="../index.html" className="block w-full py-3 text-center bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold">üè† Voltar ao Portal</a>
                    </div>
                </div>
            </div>
        );

        const BlockSelectionScreen = ({ studentName, onSelectBlock, onFinishSession }) => {
            const groupedLevels = activityBlocks.reduce((acc, block) => {
                if (!acc[block.difficulty]) acc[block.difficulty] = [];
                acc[block.difficulty].push(block);
                return acc;
            }, {});

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4">
                    <MusicPlayer />
                    <div className="max-w-7xl mx-auto">
                        <div className="text-center mb-8">
                            <h1 className="text-5xl font-bold text-white mb-2">üöÄ Ol√°, {studentName}!</h1>
                            <p className="text-2xl text-white opacity-90">Escolha um per√≠odo para correr contra o tempo!</p>
                        </div>
                        <div className="bg-white/20 backdrop-blur-sm rounded-xl p-6 mb-8 text-white text-center">
                            <h3 className="text-2xl font-bold mb-2">üìú Como Jogar</h3>
                            <p>Um evento hist√≥rico aparecer√°. Clique no ano correto na linha do tempo antes que o tempo acabe para ganhar uma estrela!</p>
                        </div>
                        {Object.entries(groupedLevels).map(([levelName, blocksInLevel]) => (
                            <div key={levelName} className="mb-12">
                                <h2 className="text-4xl font-bold text-center text-white mb-8">{levelName === 'Iniciante' && 'üå±'} {levelName === 'Intermedi√°rio' && '‚ö°'} {levelName === 'Avan√ßado' && 'üî•'} {levelName}</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {blocksInLevel.map((block) => (
                                        <div key={block.id} className="bg-white rounded-3xl shadow-xl p-6 transform transition-all hover:scale-105 cursor-pointer group" onClick={() => onSelectBlock(block)}>
                                            <div className="text-center">
                                                <div className="text-7xl mb-4">{block.emoji}</div>
                                                <h3 className={`text-2xl font-bold mb-2 bg-gradient-to-r ${block.color} bg-clip-text text-transparent`}>{block.title}</h3>
                                                <p className="text-gray-600 mb-4 text-lg">{block.description}</p>
                                                <div className="bg-gray-100 rounded-xl p-4 mb-4"><p className="text-sm text-gray-600">‚è±Ô∏è {block.questions.length} eventos contra o tempo</p></div>
                                                <button className={`w-full bg-gradient-to-r ${block.color} text-white font-bold py-4 rounded-xl text-lg`}>üèÅ CORRER</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))}
                        <div className="text-center bg-white/10 backdrop-blur-sm rounded-3xl p-6">
                            <button onClick={onFinishSession} className="bg-green-500 text-white font-bold py-4 px-8 rounded-xl text-lg hover:bg-green-600 mr-4">üíæ Finalizar Sess√£o & Baixar Resultados</button>
                            <button onClick={() => window.location.href = '../index.html'} className="bg-gray-500 text-white font-bold py-4 px-8 rounded-xl text-lg hover:bg-gray-600">üè† Voltar ao Portal</button>
                        </div>
                    </div>
                </div>
            );
        };
        
        const SummaryScreen = ({ result, onRestart, onBackToSelection }) => (
            <div className="min-h-screen bg-gradient-to-br from-green-400 via-blue-500 to-purple-600 flex items-center justify-center p-4">
                <MusicPlayer />
                <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full text-center">
                    <h2 className="text-4xl font-bold mb-4 text-gray-800">üèÅ Corrida Finalizada! üèÅ</h2>
                    <p className="text-2xl mb-8 text-gray-700">Voc√™ completou o bloco <strong>{result.Bloco}</strong>!</p>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div className="bg-yellow-50 rounded-2xl p-6">
                            <div className="text-4xl font-bold text-yellow-500">{result.Acertos} ‚≠ê</div>
                            <div className="text-lg text-gray-700">Estrelas</div>
                        </div>
                        <div className="bg-red-50 rounded-2xl p-6">
                            <div className="text-4xl font-bold text-red-600">{result.Erros}</div>
                            <div className="text-lg text-gray-700">Erros</div>
                        </div>
                        <div className="bg-orange-50 rounded-2xl p-6">
                            <div className="text-4xl font-bold text-orange-600">{result.Tempo_Execucao}</div>
                            <div className="text-lg text-gray-700">Tempo Total</div>
                        </div>
                    </div>
                    <div className="flex flex-col sm:flex-row gap-4 justify-center">
                        <button onClick={onRestart} className="bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-8 rounded-2xl text-xl">üîÑ Correr Novamente</button>
                        <button onClick={onBackToSelection} className="bg-purple-500 hover:bg-purple-600 text-white font-bold py-4 px-8 rounded-2xl text-xl">üìö Escolher Outro Per√≠odo</button>
                    </div>
                </div>
            </div>
        );

        const ActivityScreen = ({ block, onBack, onComplete }) => {
            const [questions, setQuestions] = useState([]);
            const [completed, setCompleted] = useState([]);
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [score, setScore] = useState(0);
            const [errors, setErrors] = useState(0);
            const [timeLeft, setTimeLeft] = useState(8);
            const [maxTime, setMaxTime] = useState(8);
            const [isExpertMode, setIsExpertMode] = useState(false);
            const [feedback, setFeedback] = useState({ show: false, message: '' });
            const [startTime, setStartTime] = useState(Date.now());

            useEffect(() => {
                const shuffledQuestions = [...block.questions].sort(() => Math.random() - 0.5);
                setQuestions(shuffledQuestions);
                spawnNextEvent(shuffledQuestions, []);
            }, [block]);

            useEffect(() => {
                let timer;
                if (currentQuestion && timeLeft > 0) {
                    timer = setInterval(() => setTimeLeft(t => t - 1), 1000);
                } else if (currentQuestion && timeLeft === 0) {
                    handleAnswer(null);
                }
                return () => clearInterval(timer);
            }, [currentQuestion, timeLeft]);

            const spawnNextEvent = (q, comp) => {
                if (comp.length >= block.questions.length) {
                    onComplete({ block, acertos: score, erros: errors, tempoTotal: Math.round((Date.now() - startTime) / 1000) });
                    return;
                }
                const next = q.find(event => !comp.some(c => c.id === event.id));
                setCurrentQuestion(next);
                setTimeLeft(maxTime);
            };

            const handleAnswer = (year) => {
                if (!currentQuestion) return;

                const correct = year === currentQuestion.year;
                let newCompleted = [...completed, currentQuestion];

                if (correct) {
                    SoundSystem.success();
                    setScore(s => s + 1);
                    setFeedback({ show: true, message: 'CERTEIRO! ' + (isExpertMode ? 'üöÄ' : 'üëç') });
                    if (score + 1 >= 3 && !isExpertMode) {
                        setIsExpertMode(true);
                        setMaxTime(6);
                    }
                } else {
                    SoundSystem.error();
                    setErrors(e => e + 1);
                    setFeedback({ show: true, message: year === null ? 'Tempo Esgotado!' : 'Ano Errado!' });
                }
                
                setCurrentQuestion(null);
                setTimeout(() => {
                    setFeedback({ show: false, message: '' });
                    spawnNextEvent(questions, newCompleted);
                }, 1500);
            };

            return (
                <div className={`min-h-screen bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 p-4`}>
                    <MusicPlayer />
                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white/90 backdrop-blur-sm rounded-xl p-4 mb-6">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h3 className="text-xl font-bold text-gray-800">{block.title}</h3>
                                    {isExpertMode && <p className="text-lg font-bold text-purple-600">üöÄ MODO EXPERT - 6s</p>}
                                </div>
                                <div className="text-right flex items-center gap-4">
                                    <div className="flex items-center">{[...Array(5)].map((_, i) => <span key={i} className={`text-3xl ${i < score ? 'text-yellow-400' : 'text-gray-300'}`}>‚≠ê</span>)}</div>
                                    <button onClick={onBack} className="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">‚¨ÖÔ∏è Voltar</button>
                                </div>
                            </div>
                        </div>
                        <div className="bg-white/90 backdrop-blur-sm rounded-xl p-6 mb-6 min-h-[350px] flex items-center justify-center">
                            {currentQuestion ? (
                                <div className="text-center w-full">
                                    <div className="mb-4">
                                        <div className="flex justify-center items-center mb-2"><span className="text-2xl font-bold text-gray-800 mr-3">‚è∞ {timeLeft}s</span></div>
                                        <div className="w-full bg-gray-200 rounded-full h-4 border-2 overflow-hidden"><div className={`h-full rounded-full transition-all duration-1000 ${timeLeft > maxTime * 0.6 ? 'bg-green-500' : timeLeft > maxTime * 0.3 ? 'bg-yellow-500' : 'bg-red-500'}`} style={{ width: `${(timeLeft / maxTime) * 100}%` }}></div></div>
                                    </div>
                                    <div className="bg-gradient-to-br from-yellow-100 to-orange-100 rounded-xl p-6 pulse-animation">
                                        <div className="text-4xl mb-4">{currentQuestion.icon}</div>
                                        <p className="text-xl font-semibold text-gray-800 leading-relaxed">{currentQuestion.text}</p>
                                        <button onClick={() => SoundSystem.play(currentQuestion.audio)} className="mt-4 bg-blue-500 text-white px-4 py-2 rounded-full hover:bg-blue-600">üîä Ouvir</button>
                                    </div>
                                </div>
                            ) : <div className="text-center py-8"><div className="text-6xl mb-4 animate-bounce">üèÅ</div><p className="text-2xl font-bold text-gray-800">Prepare-se!</p></div>}
                        </div>
                        <div className="bg-white/90 backdrop-blur-sm rounded-xl p-6">
                            <h3 className="text-xl font-bold text-gray-800 mb-4 text-center">üéØ Linha do Tempo - Clique no ano correto!</h3>
                            <div className="grid grid-cols-5 gap-2">
                                {block.timeline.map(year => <button key={year} onClick={() => handleAnswer(year)} disabled={!currentQuestion} className={`p-4 rounded-xl border-4 transition-all text-center font-bold text-xl ${!currentQuestion ? 'bg-gray-200 border-gray-300 text-gray-400' : 'border-orange-400 bg-orange-50 hover:bg-orange-200 hover:scale-105'}`}>{year}</button>)}
                            </div>
                        </div>
                        {feedback.show && <div className="fixed top-10 left-1/2 -translate-x-1/2 text-white font-bold py-3 px-6 rounded-xl shadow-lg z-50 bg-black bg-opacity-70">{feedback.message}</div>}
                    </div>
                </div>
            );
        };

        const AtividadeTemplate = () => {
            const [studentName, setStudentName] = useState(localStorage.getItem('studentName') || '');
            const [font, setFont] = useState(localStorage.getItem('selectedFont') === 'dyslexic' ? 'OpenDyslexic' : 'Comic Sans MS');
            const [currentScreen, setCurrentScreen] = useState('initial');
            const [selectedBlock, setSelectedBlock] = useState(null);
            const [sessionResults, setSessionResults] = useState([]);
            const [lastResult, setLastResult] = useState(null);

            useEffect(() => {
                document.title = activityConfig.title;
                document.body.className = font === 'OpenDyslexic' ? 'font-dyslexic' : '';
            }, [font]);

            const handleStart = (name) => {
                if (name.trim()) {
                    setStudentName(name);
                    localStorage.setItem('studentName', name);
                    setCurrentScreen('blockSelection');
                }
            };

            const handleSelectBlock = (block) => {
                setSelectedBlock(block);
                setCurrentScreen('activity');
            };
            
            const handleCompleteBlock = (result) => {
                const newResult = {
                    Nome: studentName,
                    Materia: activityConfig.subject,
                    Atividade: activityConfig.activity,
                    Bloco: result.block.title,
                    Questao: `${result.block.questions.length}_eventos`,
                    Tempo_Execucao: `${result.tempoTotal}s`,
                    Acertos: result.acertos,
                    Erros: result.erros,
                    Score: '100%'
                };
                setSessionResults(prev => [...prev, newResult]);
                setLastResult(newResult);
                setCurrentScreen('summary');
            };

            const handleFinishSession = () => {
                if (sessionResults.length === 0) {
                    alert("Nenhuma atividade foi completada para gerar o relat√≥rio.");
                    return;
                }
                const header = 'Nome,Materia,Atividade,Bloco,Questao,Tempo_Execucao,Acertos,Erros,Score\n';
                const csvContent = sessionResults.map(r => Object.values(r).join(',')).join('\n');
                const blob = new Blob([header + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.href = url;
                const dateStr = new Date().toLocaleDateString('pt-BR').replace(/\//g, '-') ;
                const studentNameForFile = studentName.replace(/[^a-zA-Z0-9]/g, '_');
                link.download = `${activityConfig.activity}_${studentNameForFile}_${dateStr}.csv`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                alert("üéâ Dados exportados com sucesso!");
            };

            const restartBlock = () => {
                setCurrentScreen('activity');
            };

            switch (currentScreen) {
                case 'initial':
                    return <InitialScreen onStart={handleStart} studentName={studentName} setStudentName={setStudentName} font={font} setFont={setFont} />;
                case 'blockSelection':
                    return <BlockSelectionScreen studentName={studentName} onSelectBlock={handleSelectBlock} onFinishSession={handleFinishSession} />;
                case 'activity':
                    return <ActivityScreen block={selectedBlock} onBack={() => setCurrentScreen('blockSelection')} onComplete={handleCompleteBlock} />;
                case 'summary':
                    return <SummaryScreen result={lastResult} onRestart={restartBlock} onBackToSelection={() => setCurrentScreen('blockSelection')} />;
                default:
                    return <InitialScreen onStart={handleStart} studentName={studentName} setStudentName={setStudentName} font={font} setFont={setFont} />;
            }
        };

        ReactDOM.render(<AtividadeTemplate />, document.getElementById('root'));
    </script>
</body>
</html>
