<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Figuras GeomÃ©tricas com Roblox</title>
    
    <!-- DependÃªncias PadrÃ£o (React, TailwindCSS, Fontes) -->
    <link href="https://fonts.googleapis.com/css2?family=Comic+Sans+MS:wght@400;700&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../VariableProximity.css">
    <script src="../variable-proximity-effect.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @font-face {
          font-family: 'OpenDyslexic';
          src: url('../media/fonts/OpenDyslexic-Regular.otf') format('opentype');
          font-weight: normal;
          font-style: normal;
        }
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
        }
        .font-dyslexic {
            font-family: 'OpenDyslexic', 'Comic Sans MS', cursive, sans-serif;
        }
        .correct-answer-animation {
            animation: pulse-green 0.8s ease-in-out;
        }
        @keyframes pulse-green {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 10px 10px rgba(34, 197, 94, 0); }
        }
        .wrong-answer-animation {
            animation: shake-red 0.5s ease-in-out;
        }
        @keyframes shake-red {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .celebration-popup {
            animation: fade-in 0.5s ease-out;
        }
        @keyframes fade-in {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        

        // ===================================================================================
        // --- CONFIGURAÃ‡ÃƒO DA ATIVIDADE ---
        // ===================================================================================
        const activityConfig = {
            title: "Figuras GeomÃ©tricas com Roblox",
            subject: "matematica",
            activity: "figuras_geometricas_roblox",
            emoji: "ğŸ”·",
            primaryColor: "blue",
        };

        const activityBlocks = [
            {
                id: 1,
                title: "Aventura do Construtor Novato",
                difficulty: "Iniciante",
                emoji: "â­",
                color: "from-yellow-400 to-amber-500",
                description: "Combine as formas mais simples para comeÃ§ar sua jornada.",
                challenge: {
                    id: "bloco_1_desafio_1",
                    figures: ['cÃ­rculo', 'quadrado', 'triÃ¢ngulo', 'retÃ¢ngulo'],
                    targets: [
                        { id: 1, name: 'CabeÃ§a do Personagem', shape: 'cÃ­rculo', emoji: 'ğŸ˜€' },
                        { id: 2, name: 'Bloco de Terra', shape: 'quadrado', emoji: 'ğŸŸ«' },
                        { id: 3, name: 'Telhado Pontudo', shape: 'triÃ¢ngulo', emoji: 'ğŸ”¼' },
                        { id: 4, name: 'Porta MÃ¡gica', shape: 'retÃ¢ngulo', emoji: 'ğŸšª' },
                        { id: 5, name: 'Janela da Casa', shape: 'quadrado', emoji: 'ğŸªŸ' }
                    ]
                }
            },
            {
                id: 2,
                title: "MissÃ£o: Lar Doce Lar GeomÃ©trico",
                difficulty: "Iniciante",
                emoji: "ğŸ ",
                color: "from-green-400 to-teal-500",
                description: "Use as formas para construir uma casa incrÃ­vel.",
                challenge: {
                    id: "bloco_2_desafio_1",
                    figures: ['quadrado', 'retÃ¢ngulo', 'triÃ¢ngulo', 'cÃ­rculo', 'losango'],
                    targets: [
                        { id: 1, name: 'Janela PanorÃ¢mica', shape: 'quadrado', emoji: 'ğŸ–¼ï¸' },
                        { id: 2, name: 'Parede de Tijolos', shape: 'retÃ¢ngulo', emoji: 'ğŸ§±' },
                        { id: 3, name: 'Telhado Principal', shape: 'triÃ¢ngulo', emoji: 'ğŸ¡' },
                        { id: 4, name: 'Rodas do Carrinho', shape: 'cÃ­rculo', emoji: 'âš«' },
                        { id: 5, name: 'Piso de Diamante', shape: 'losango', emoji: 'ğŸ’ ' }
                    ]
                }
            },
            {
                id: 3,
                title: "A Forja do HerÃ³i Poligonal",
                difficulty: "IntermediÃ¡rio",
                emoji: "ğŸ›¡ï¸",
                color: "from-blue-400 to-cyan-500",
                description: "Equipe seu herÃ³i com itens feitos de polÃ­gonos.",
                challenge: {
                    id: "bloco_3_desafio_1",
                    figures: ['pentÃ¡gono', 'hexÃ¡gono', 'octÃ³gono', 'triÃ¢ngulo', 'cÃ­rculo'],
                    targets: [
                        { id: 1, name: 'Escudo do GuardiÃ£o', shape: 'pentÃ¡gono', emoji: 'ğŸ›¡ï¸' },
                        { id: 2, name: 'NÃºcleo de Energia', shape: 'hexÃ¡gono', emoji: 'âš™ï¸' },
                        { id: 3, name: 'Sinal de Pare', shape: 'octÃ³gono', emoji: 'ğŸ›‘' },
                        { id: 4, name: 'ChapÃ©u do Mago', shape: 'triÃ¢ngulo', emoji: 'ğŸ§™' },
                        { id: 5, name: 'Lente dos Ã“culos', shape: 'cÃ­rculo', emoji: 'ğŸ•¶ï¸' }
                    ]
                }
            },
            {
                id: 4,
                title: "O Desafio da Pista Radical",
                difficulty: "IntermediÃ¡rio",
                emoji: "ğŸ›¹",
                color: "from-purple-400 to-fuchsia-500",
                description: "Construa uma pista de obstÃ¡culos com quadrilÃ¡teros.",
                challenge: {
                    id: "bloco_4_desafio_1",
                    figures: ['retÃ¢ngulo', 'cÃ­rculo', 'triÃ¢ngulo', 'trapÃ©zio', 'paralelogramo'],
                    targets: [
                        { id: 1, name: 'TÃºnel Escuro', shape: 'retÃ¢ngulo', emoji: 'ğŸš‡' },
                        { id: 2, name: 'Roda Gigante', shape: 'cÃ­rculo', emoji: 'ğŸ¡' },
                        { id: 3, name: 'Rampa de Salto', shape: 'triÃ¢ngulo', emoji: 'ğŸ“' },
                        { id: 4, name: 'Plataforma Inclinada', shape: 'trapÃ©zio', emoji: 'ğŸ¢' },
                        { id: 5, name: 'Ponte Deslizante', shape: 'paralelogramo', emoji: 'ğŸŒ‰' }
                    ]
                }
            },
            {
                id: 5,
                title: "Modo Criativo: Arquiteto de Games",
                difficulty: "AvanÃ§ado",
                emoji: "ğŸ®",
                color: "from-red-500 to-orange-500",
                description: "Crie os elementos de um jogo usando formas complexas.",
                challenge: {
                    id: "bloco_5_desafio_1",
                    figures: ['cÃ­rculo', 'quadrado', 'triÃ¢ngulo', 'hexÃ¡gono', 'octÃ³gono'],
                    targets: [
                        { id: 1, name: 'BotÃ£o de Start', shape: 'cÃ­rculo', emoji: 'â–¶ï¸' },
                        { id: 2, name: 'Plataforma Flutuante', shape: 'quadrado', emoji: 'ğŸŸ©' },
                        { id: 3, name: 'Seta de DireÃ§Ã£o', shape: 'triÃ¢ngulo', emoji: 'â¡ï¸' },
                        { id: 4, name: 'Favo de Mel Premiado', shape: 'hexÃ¡gono', emoji: 'ğŸ¯' },
                        { id: 5, name: 'Portal de Teletransporte', shape: 'octÃ³gono', emoji: 'ğŸŒ€' }
                    ]
                }
            },
            // Aventuras GalÃ¡cticas de Figuras Planas
            {
                id: 6,
                title: "TriÃ¢ngulo TitÃ£ ğŸ›¸",
                difficulty: "Iniciante",
                emoji: "ğŸ”º",
                color: "from-yellow-400 to-orange-500",
                description: "Descubra onde o triÃ¢ngulo se esconde na galÃ¡xia!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q1",
                        statement: "Qual dessas formas tem 3 lados e 3 vÃ©rtices?",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "â­• CÃ­rculo" },
                            { id: "d", text: "â–­ RetÃ¢ngulo" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸ‰ Isso mesmo! O triÃ¢ngulo tem 3 lados. Veja a constelaÃ§Ã£o se formando... ğŸŒŸ",
                            incorrect: "ğŸ’¡ Quase! O triÃ¢ngulo Ã© a forma com 3 lados. Olhe bem nos cantos!"
                        }
                    },
                    {
                        id: "q2",
                        statement: "Qual objeto do espaÃ§o parece um triÃ¢ngulo?",
                        options: [
                            { id: "a", text: "ğŸ›¸ OVNI" },
                            { id: "b", text: "ğŸª Planeta" },
                            { id: "c", text: "â˜„ï¸ Cometa" },
                            { id: "d", text: "ğŸ›°ï¸ SatÃ©lite" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸš€ UAU! Muitos OVNIs sÃ£o desenhados como triÃ¢ngulos! ConstelaÃ§Ã£o atualizada! ğŸ”º",
                            incorrect: "ğŸ›¸ Dica: pense em naves famosas... Elas costumam ter formato de triÃ¢ngulo!"
                        }
                    },
                    {
                        id: "q3",
                        statement: "Em uma pizza triangular, quantos pedaÃ§os vocÃª obtÃ©m se cortar do centro atÃ© cada ponta?",
                        options: [
                            { id: "a", text: "2 pedaÃ§os" },
                            { id: "b", text: "3 pedaÃ§os" },
                            { id: "c", text: "4 pedaÃ§os" },
                            { id: "d", text: "6 pedaÃ§os" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ• DELICIOSO! 3 cortes do centro = 3 pedaÃ§os triangulares! Que fome cÃ³smica! ğŸŒŸ",
                            incorrect: "ğŸ”º Dica: cada lado do triÃ¢ngulo gera um pedaÃ§o!"
                        }
                    },
                    {
                        id: "q4",
                        statement: "Qual instrumento musical tem formato triangular?",
                        options: [
                            { id: "a", text: "ğŸ¸ ViolÃ£o" },
                            { id: "b", text: "ğŸ¥ Bateria" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "ğŸ¹ Piano" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸµ MÃšSICA PERFEITA! O triÃ¢ngulo musical faz aquele som mÃ¡gico! ğŸ”ºâœ¨",
                            incorrect: "ğŸ¶ Dica: tem o mesmo nome da figura geomÃ©trica!"
                        }
                    },
                    {
                        id: "q5",
                        statement: "Se vocÃª juntar dois triÃ¢ngulos iguais pela base, que figura forma?",
                        options: [
                            { id: "a", text: "ğŸ”· Quadrado" },
                            { id: "b", text: "ğŸ”¸ Losango" },
                            { id: "c", text: "â–­ RetÃ¢ngulo" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ’ DIAMANTE ESTELAR! Dois triÃ¢ngulos = um losango brilhante! ğŸŒŸğŸ”¸",
                            incorrect: "ğŸ”ºâ•ğŸ”º Dica: fica com formato de diamante!"
                        }
                    }
                ]
            },
            {
                id: 7,
                title: "Quadrado Quantum ğŸ’¥",
                difficulty: "IntermediÃ¡rio",
                emoji: "ğŸ”·",
                color: "from-purple-400 to-pink-500",
                description: "Desvende os segredos dos 4 lados iguais!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q3",
                        statement: "Quantos lados tem um quadrado?",
                        options: [
                            { id: "a", text: "2" },
                            { id: "b", text: "3" },
                            { id: "c", text: "4" },
                            { id: "d", text: "5" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸ”¢ Perfeito! 4 lados iguais = quadrado! A constelaÃ§Ã£o brilha mais! âœ¨",
                            incorrect: "ğŸ“ Dica: 'Quadra' vem de quatro! Sempre 4 lados!"
                        }
                    },
                    {
                        id: "q4",
                        statement: "Qual janela de foguete Ã© um quadrado?",
                        options: [
                            { id: "a", text: "ğŸªŸ Redonda" },
                            { id: "b", text: "ğŸ”· Com 4 lados iguais" },
                            { id: "c", text: "â–­ Longa e fina" },
                            { id: "d", text: "ğŸ”º Pontuda" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ‘€ Excelente! O quadrado Ã© perfeito para janelas fortes! Nova estrela conectada! â­",
                            incorrect: "ğŸª Pense: qual tem todos os lados do mesmo tamanho?"
                        }
                    },
                    {
                        id: "q6",
                        statement: "Um dado de jogo tem quantas faces quadradas?",
                        options: [
                            { id: "a", text: "4 faces" },
                            { id: "b", text: "5 faces" },
                            { id: "c", text: "6 faces" },
                            { id: "d", text: "8 faces" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸ² SORTE MÃXIMA! 6 faces quadradas fazem o cubo perfeito! Quantum ativado! âš¡",
                            incorrect: "ğŸ”¢ Dica: conte as faces de um cubo mÃ¡gico!"
                        }
                    },
                    {
                        id: "q7",
                        statement: "Qual destas telas tem formato mais prÃ³ximo de um quadrado?",
                        options: [
                            { id: "a", text: "ğŸ“± Celular vertical" },
                            { id: "b", text: "ğŸ“º TV widescreen" },
                            { id: "c", text: "ğŸ’» Monitor quadrado" },
                            { id: "d", text: "ğŸ“ RÃ©gua digital" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸ’» TELA QUÃ‚NTICA! Monitor quadrado = perfeiÃ§Ã£o geomÃ©trica! ğŸ”·âœ¨",
                            incorrect: "ğŸ–¥ï¸ Dica: procure pela tela mais 'quadradinha'!"
                        }
                    },
                    {
                        id: "q8",
                        statement: "Em um tabuleiro de xadrez, cada casa Ã© um:",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "â­• CÃ­rculo" },
                            { id: "d", text: "ğŸ”¸ Losango" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "â™Ÿï¸ XEQUE-MATE GEOMÃ‰TRICO! 64 quadrados perfeitos no tabuleiro! ğŸ†",
                            incorrect: "â™› Dica: cada casa do xadrez tem 4 lados iguais!"
                        }
                    }
                ]
            },
            {
                id: 8,
                title: "CÃ­rculo CÃ³smico ğŸŒ•",
                difficulty: "Iniciante",
                emoji: "â­•",
                color: "from-blue-400 to-cyan-500",
                description: "Rode pelo universo redondo e encontre os cÃ­rculos!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q5",
                        statement: "Qual figura NÃƒO tem lados nem vÃ©rtices?",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "â­• CÃ­rculo" },
                            { id: "d", text: "â–­ RetÃ¢ngulo" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸŒ€ Isso! O cÃ­rculo Ã© redondinho e sem pontas! A lua sorri para vocÃª! ğŸŒ•",
                            incorrect: "ğŸ–ï¸ Dica: procure a figura que rola sem esbarrar!"
                        }
                    },
                    {
                        id: "q6",
                        statement: "Qual planeta Ã© redondo como um cÃ­rculo?",
                        options: [
                            { id: "a", text: "ğŸª Saturno" },
                            { id: "b", text: "â˜„ï¸ Cometa" },
                            { id: "c", text: "ğŸ›°ï¸ Antena" },
                            { id: "d", text: "ğŸš€ Foguete" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸª ParabÃ©ns! Todos os planetas sÃ£o redondos! VocÃª iluminou a galÃ¡xia! ğŸŒŒ",
                            incorrect: "ğŸŒ Dica: gira, giraâ€¦ e Ã© redondo como uma bola!"
                        }
                    },
                    {
                        id: "q9",
                        statement: "Qual dessas rodas Ã© a mais redonda?",
                        options: [
                            { id: "a", text: "ğŸ› Roda de carro" },
                            { id: "b", text: "â¬œ Roda quadrada" },
                            { id: "c", text: "ğŸ”º Roda triangular" },
                            { id: "d", text: "â–­ Roda retangular" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸš— PERFEITO! Rodas de carro sÃ£o cÃ­rculos perfeitos para rolar suave! ğŸŒ€",
                            incorrect: "ğŸ› Dica: qual roda rolaria sem saltitar?"
                        }
                    },
                    {
                        id: "q10",
                        statement: "Se vocÃª desenhar do centro de um cÃ­rculo atÃ© a borda, como se chama essa linha?",
                        options: [
                            { id: "a", text: "ğŸ“ DiÃ¢metro" },
                            { id: "b", text: "ğŸ“ Raio" },
                            { id: "c", text: "ğŸ“Š Lado" },
                            { id: "d", text: "ğŸ“ˆ VÃ©rtice" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ“ RAIO DE GENIALIDADE! Do centro atÃ© a borda = raio cÃ³smico! â­•âœ¨",
                            incorrect: "ğŸ¯ Dica: como um raio de sol do centro!"
                        }
                    },
                    {
                        id: "q11",
                        statement: "Quantos cÃ­rculos vocÃª consegue ver em uma roda de bicicleta?",
                        options: [
                            { id: "a", text: "1 cÃ­rculo" },
                            { id: "b", text: "2 cÃ­rculos" },
                            { id: "c", text: "3 cÃ­rculos" },
                            { id: "d", text: "Muitos cÃ­rculos" }
                        ],
                        correct: "d",
                        feedback: {
                            correct: "ğŸš² CICLISTA CÃ“SMICO! Roda, pneu, raiosâ€¦ cÃ­rculos por toda parte! ğŸŒ€ğŸŒŸ",
                            incorrect: "ğŸ”„ Dica: olhe bemâ€¦ tem cÃ­rculos dentro de cÃ­rculos!"
                        }
                    }
                ]
            },
            {
                id: 9,
                title: "HexÃ¡gono Hiperdrive âš¡",
                difficulty: "AvanÃ§ado",
                emoji: "â¬¡",
                color: "from-green-400 to-teal-500",
                description: "Domine a figura com 6 lados e libere o hiperdrive!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q7",
                        statement: "Quantos lados tem um hexÃ¡gono?",
                        options: [
                            { id: "a", text: "4" },
                            { id: "b", text: "5" },
                            { id: "c", text: "6" },
                            { id: "d", text: "7" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "âš¡ Hiperdrive ativado! HexÃ¡gono = 6 lados! Sua nave acelera! ğŸš€ğŸ’«",
                            incorrect: "ğŸ”¢ 'Hexa' significa seis! Conte os lados com calma!"
                        }
                    },
                    {
                        id: "q8",
                        statement: "Onde vocÃª vÃª um hexÃ¡gono na natureza?",
                        options: [
                            { id: "a", text: "ğŸ Colmeia de abelhas" },
                            { id: "b", text: "ğŸŒ³ Tronco de Ã¡rvore" },
                            { id: "c", text: "ğŸŒŠ Onda do mar" },
                            { id: "d", text: "â˜ï¸ Nuvem" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸ¯ GENIAL! As abelhas sÃ£o arquitetas geomÃ©tricas! ConstelaÃ§Ã£o final completa! ğŸŒŸğŸŒŸğŸŒŸ",
                            incorrect: "ğŸ Dica: quem faz favos perfeitos em forma de seis lados?"
                        }
                    },
                    {
                        id: "q12",
                        statement: "Uma moeda de 1 real tem quantos lados?",
                        options: [
                            { id: "a", text: "0 lados" },
                            { id: "b", text: "6 lados" },
                            { id: "c", text: "8 lados" },
                            { id: "d", text: "10 lados" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸ’° RIQUEZA GEOMÃ‰TRICA! Moedas sÃ£o redondas, sem lados! Hiperdrive financeiro! âš¡",
                            incorrect: "ğŸª™ Dica: moedas rolam porque sÃ£o redondas!"
                        }
                    },
                    {
                        id: "q13",
                        statement: "Se vocÃª unir 6 triÃ¢ngulos iguais pelas pontas, que figura forma?",
                        options: [
                            { id: "a", text: "â¬¡ HexÃ¡gono" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "â­• CÃ­rculo" },
                            { id: "d", text: "ğŸ”¸ Losango" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "âš¡ HEXÃGONO TURBINADO! 6 triÃ¢ngulos = hiperdrive ativado! ğŸš€â¬¡",
                            incorrect: "ğŸ”ºÃ—6 Dica: seis lados unidos formam uma super figura!"
                        }
                    },
                    {
                        id: "q14",
                        statement: "Qual jogo usa um tabuleiro com cÃ©lulas hexagonais?",
                        options: [
                            { id: "a", text: "â™Ÿï¸ Xadrez" },
                            { id: "b", text: "ğŸ¯ Damas" },
                            { id: "c", text: "â¬¡ Settlers of Catan" },
                            { id: "d", text: "ğŸ² Ludo" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸï¸ COLONO HEXAGONAL! Catan usa hexÃ¡gonos para as ilhas! Hiperdrive final! âš¡â¬¡",
                            incorrect: "ğŸ² Dica: jogo de estratÃ©gia com ilhas de 6 lados!"
                        }
                    }
                ]
            },
            // Aventuras Esportivas
            {
                id: 10,
                title: "Futebol: O Campo de Batalha âš½",
                difficulty: "IntermediÃ¡rio",
                emoji: "âš½",
                color: "from-green-400 to-emerald-500",
                description: "Descubra as formas escondidas no gramado!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q1",
                        statement: "Qual figura tem 4 lados iguais e 4 Ã¢ngulos retos, como o centro do campo?",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "â–­ RetÃ¢ngulo" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "âœ… PERFEITO! O centro do campo Ã© um quadrado! Torcida vibra! ğŸ‰ğŸ‘",
                            incorrect: "ğŸŸ¢ Dica: pense em algo com todos os lados iguais e cantos em 90Â°!"
                        }
                    },
                    {
                        id: "q2",
                        statement: "O gol tem formato parecido com qual figura?",
                        options: [
                            { id: "a", text: "â–­ RetÃ¢ngulo" },
                            { id: "b", text: "â¬¡ HexÃ¡gono" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸ¥… GOLAÃ‡O GEOMÃ‰TRICO! O gol Ã© um retÃ¢ngulo! VibraÃ§Ã£o total! ğŸ”Š",
                            incorrect: "ğŸ¥… Dica: tem dois lados longos e dois curtosâ€¦ igual Ã  trave!"
                        }
                    },
                    {
                        id: "q15",
                        statement: "A bola de futebol tem formato de qual figura geomÃ©trica?",
                        options: [
                            { id: "a", text: "ğŸ”· Quadrado" },
                            { id: "b", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "c", text: "âš½ Esfera (3D do cÃ­rculo)" },
                            { id: "d", text: "ğŸ”¸ Losango" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "âš½ CHUTE PERFEITO! A bola Ã© uma esfera, versÃ£o 3D do cÃ­rculo! GOOOOL! ğŸ¯",
                            incorrect: "ğŸ¥… Dica: Ã© redonda como um cÃ­rculo, mas em 3 dimensÃµes!"
                        }
                    },
                    {
                        id: "q16",
                        statement: "Quantos lados tem o campo de futebol visto de cima?",
                        options: [
                            { id: "a", text: "3 lados" },
                            { id: "b", text: "4 lados" },
                            { id: "c", text: "5 lados" },
                            { id: "d", text: "6 lados" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸŸï¸ ESTÃDIO GEOMÃ‰TRICO! 4 lados fazem o retÃ¢ngulo do campo! Torcida delira! ğŸ‰",
                            incorrect: "âš½ Dica: como um retÃ¢ngulo verde gigante!"
                        }
                    },
                    {
                        id: "q17",
                        statement: "A Ã¡rea do goleiro (pequena Ã¡rea) tem formato de:",
                        options: [
                            { id: "a", text: "â­• CÃ­rculo" },
                            { id: "b", text: "â–­ RetÃ¢ngulo" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "â¬¡ HexÃ¡gono" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ§¤ DEFESA GEOMÃ‰TRICA! Ãrea pequena = retÃ¢ngulo protetor! Goleiro herÃ³i! ğŸ†",
                            incorrect: "ğŸ¥… Dica: Ã© uma caixa retangular na frente do gol!"
                        }
                    }
                ]
            },
            {
                id: 11,
                title: "VÃ´lei: No Ar com Estilo ğŸ",
                difficulty: "IntermediÃ¡rio",
                emoji: "ğŸ",
                color: "from-orange-400 to-red-500",
                description: "Ataque, bloqueioâ€¦ e muita geometria no saque!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q3",
                        statement: "A rede de vÃ´lei Ã© feita de pequenos losangos ouâ€¦?",
                        options: [
                            { id: "a", text: "ğŸ”· Quadrados" },
                            { id: "b", text: "ğŸ”º TriÃ¢ngulos" },
                            { id: "c", text: "ğŸ”¸ Losangos" },
                            { id: "d", text: "â­• CÃ­rculos" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸ ACE! Isso mesmo, sÃ£o losangos! Rede perfeita! ğŸŒŸ",
                            incorrect: "ğŸ•¸ï¸ Dica: forma de 'diamante' nas malhas da rede!"
                        }
                    },
                    {
                        id: "q4",
                        statement: "Quando o jogador levanta a bola, ela descreve um arco. Qual figura representa esse movimento?",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "â–­ RetÃ¢ngulo" },
                            { id: "c", text: "â­• CÃ­rculo" },
                            { id: "d", text: "â—¡ SemicÃ­rculo" }
                        ],
                        correct: "d",
                        feedback: {
                            correct: "ğŸŒ€ LINDO LEVANTAMENTO! O arco Ã© um semicÃ­rculo! ğŸ¤©",
                            incorrect: "ğŸ‘† Dica: metade de um cÃ­rculoâ€¦ como um sorriso no cÃ©u!"
                        }
                    },
                    {
                        id: "q18",
                        statement: "A quadra de vÃ´lei vista de cima Ã© um:",
                        options: [
                            { id: "a", text: "ğŸ”· Quadrado" },
                            { id: "b", text: "â–­ RetÃ¢ngulo" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ SAQUE ACE! A quadra Ã© um retÃ¢ngulo dividido pela rede! Ponto! ğŸŒŸ",
                            incorrect: "ğŸ Dica: Ã© maior na largura que na altura!"
                        }
                    },
                    {
                        id: "q19",
                        statement: "Se a bola de vÃ´lei fosse achatada, viraria um:",
                        options: [
                            { id: "a", text: "â­• CÃ­rculo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "ğŸ”¸ Losango" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸ CORTADA PERFEITA! Bola achatada = cÃ­rculo plano! Que jogada! â­•",
                            incorrect: "ğŸ Dica: imagine amassar uma bola redonda!"
                        }
                    },
                    {
                        id: "q20",
                        statement: "Quantas linhas retas delimitam uma quadra de vÃ´lei?",
                        options: [
                            { id: "a", text: "2 linhas" },
                            { id: "b", text: "4 linhas" },
                            { id: "c", text: "6 linhas" },
                            { id: "d", text: "8 linhas" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸ BLOQUEIO GEOMÃ‰TRICO! 4 linhas formam o retÃ¢ngulo da quadra! Defense! ğŸ›¡ï¸",
                            incorrect: "ğŸ“ Dica: conte as bordas de um retÃ¢ngulo!"
                        }
                    }
                ]
            },
            {
                id: 12,
                title: "Capoeira: DanÃ§a com Simetria ğŸ¥‹",
                difficulty: "AvanÃ§ado",
                emoji: "ğŸ¦µ",
                color: "from-yellow-400 to-orange-500",
                description: "Ginga, marteloâ€¦ e figuras no corpo em movimento!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q5",
                        statement: "Na posiÃ§Ã£o de 'bananeira', o corpo forma qual figura?",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "â–­ RetÃ¢ngulo" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸ•º INCREDÃVEL! O corpo em V forma um triÃ¢ngulo! Capoeira geomÃ©trica! ğŸ¶",
                            incorrect: "ğŸ§˜ Dica: trÃªs pontos: duas mÃ£os e os pÃ©s no ar!"
                        }
                    },
                    {
                        id: "q6",
                        statement: "O roda de capoeira Ã© montada em formato circular. Quantos lados tem um cÃ­rculo?",
                        options: [
                            { id: "a", text: "0" },
                            { id: "b", text: "1" },
                            { id: "c", text: "2" },
                            { id: "d", text: "Infinitos" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸŒ€ MESTRE DO CÃRCULO! CÃ­rculo nÃ£o tem lados nem vÃ©rtices! Berimbau toca! ğŸª˜",
                            incorrect: "ğŸ¶ Dica: rola, rolaâ€¦ mas nunca tem pontas!"
                        }
                    },
                    {
                        id: "q21",
                        statement: "O movimento 'meia-lua' da capoeira desenha no ar um:",
                        options: [
                            { id: "a", text: "ğŸ”· Quadrado" },
                            { id: "b", text: "â—¡ SemicÃ­rculo" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "â–­ RetÃ¢ngulo" }
                        ],
                        correct: "b",
                        feedback: {
                            correct: "ğŸŒ™ MEIA-LUA PERFEITA! O pÃ© desenha um semicÃ­rculo no ar! AxÃ©! ğŸ¶",
                            incorrect: "ğŸ¦µ Dica: 'meia-lua' = metade de um cÃ­rculo!"
                        }
                    },
                    {
                        id: "q22",
                        statement: "Quando dois capoeiristas fazem a 'ginga' um de frente para o outro, formam:",
                        options: [
                            { id: "a", text: "ğŸ“ Linhas paralelas" },
                            { id: "b", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "c", text: "â­• CÃ­rculo imaginÃ¡rio" },
                            { id: "d", text: "ğŸ”· Quadrado" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸ•º RODA SAGRADA! A ginga cria um cÃ­rculo de energia invisÃ­vel! Mandinga! â­•",
                            incorrect: "ğŸ¶ Dica: a roda de capoeira Ã© sempre redonda!"
                        }
                    },
                    {
                        id: "q23",
                        statement: "O berimbau tem formato parecido com qual figura?",
                        options: [
                            { id: "a", text: "ğŸ¹ Arco (parte de cÃ­rculo)" },
                            { id: "b", text: "ğŸ“ Linha reta" },
                            { id: "c", text: "ğŸ”· Quadrado" },
                            { id: "d", text: "ğŸ”º TriÃ¢ngulo" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸª˜ SOM GEOMÃ‰TRICO! O berimbau Ã© curvado como um arco! Que toque! ğŸµ",
                            incorrect: "ğŸ¶ Dica: Ã© curvado como um pedaÃ§o de cÃ­rculo!"
                        }
                    }
                ]
            },
            {
                id: 13,
                title: "Pipa: No CÃ©u com Estilo ğŸª",
                difficulty: "AvanÃ§ado",
                emoji: "ğŸª",
                color: "from-purple-400 to-pink-500",
                description: "Altura, ventoâ€¦ e figuras voando!",
                isQuizMode: true,
                questions: [
                    {
                        id: "q7",
                        statement: "A pipa tradicional tem formato de qual figura?",
                        options: [
                            { id: "a", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "b", text: "ğŸ”· Quadrado" },
                            { id: "c", text: "ğŸ”¸ Losango" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸª VOANDO ALTO! A pipa Ã© um losango! Brilha no cÃ©u! âœ¨",
                            incorrect: "ğŸ§µ Dica: quatro lados iguais, mas nÃ£o Ã© um quadradoâ€¦ Ã© mais 'pontudo'!"
                        }
                    },
                    {
                        id: "q8",
                        statement: "Se cortarmos uma pipa ao meio pela diagonal, obtemos duas figuras. Quais?",
                        options: [
                            { id: "a", text: "2 triÃ¢ngulos" },
                            { id: "b", text: "2 quadrados" },
                            { id: "c", text: "2 retÃ¢ngulos" },
                            { id: "d", text: "2 cÃ­rculos" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "âœ‚ï¸ GENIAL! Um losango cortado vira dois triÃ¢ngulos! ğŸ¯",
                            incorrect: "ğŸ“ Dica: toda divisÃ£o de losango por diagonal gera triÃ¢ngulos!"
                        }
                    },
                    {
                        id: "q24",
                        statement: "A linha da pipa (rabiola) quando estica no vento forma uma:",
                        options: [
                            { id: "a", text: "ğŸ“ Linha reta" },
                            { id: "b", text: "ğŸŒŠ Linha curva" },
                            { id: "c", text: "ğŸ”º TriÃ¢ngulo" },
                            { id: "d", text: "â­• CÃ­rculo" }
                        ],
                        correct: "a",
                        feedback: {
                            correct: "ğŸª VENTO PERFEITO! Linha esticada = reta geomÃ©trica no cÃ©u! Que altura! ğŸ“",
                            incorrect: "ğŸ§µ Dica: quando estica bem, fica retinha!"
                        }
                    },
                    {
                        id: "q25",
                        statement: "Se vocÃª olhar uma pipa de frente, ela parece ter quantos 'cantos' (vÃ©rtices)?",
                        options: [
                            { id: "a", text: "2 cantos" },
                            { id: "b", text: "3 cantos" },
                            { id: "c", text: "4 cantos" },
                            { id: "d", text: "6 cantos" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "ğŸª PIPA PERFEITA! 4 cantos fazem o losango voador! Que espetÃ¡culo! ğŸ”¸",
                            incorrect: "ğŸ”¸ Dica: conte as pontas do losango!"
                        }
                    },
                    {
                        id: "q26",
                        statement: "A sombra de uma pipa no chÃ£o tem a mesma forma da pipa?",
                        options: [
                            { id: "a", text: "âœ… Sim, sempre" },
                            { id: "b", text: "âŒ NÃ£o, nunca" },
                            { id: "c", text: "ğŸ¤” Depende da posiÃ§Ã£o do sol" },
                            { id: "d", text: "ğŸ”„ SÃ³ quando gira" }
                        ],
                        correct: "c",
                        feedback: {
                            correct: "â˜€ï¸ SOMBRA GEOMÃ‰TRICA! Depende do Ã¢ngulo do sol! Geometria e fÃ­sica juntas! ğŸª",
                            incorrect: "ğŸŒ… Dica: pense em como a sombra muda durante o dia!"
                        }
                    }
                ]
            }
        ];
        // ===================================================================================
        // --- FIM DA CONFIGURAÃ‡ÃƒO ---
        // ===================================================================================

        // --- SISTEMA DE FEEDBACK SONORO ---
        const SoundSystem = {
            play: (src) => {
                const audio = new Audio(src);
                    audio.play().catch(e => {});
                    audio.onended = () => {};
            },
            success: () => {
                const soundId = Math.floor(Math.random() * 3) + 1;
                SoundSystem.play(`../media/sons/feedback/acertos/acerto_${soundId}.mp3`);
            },
            error: () => {
                const soundId = Math.floor(Math.random() * 3) + 1;
                SoundSystem.play(`../media/sons/feedback/erros/erro_${soundId}.mp3`);
            },
            click: () => SoundSystem.play('../media/sons/feedback/click.mp3')
        };

        // --- COMPONENTES REACT ---

        const InitialScreen = ({ onStart, studentName, setStudentName, font, setFont }) => (
            <div className={`min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 flex items-center justify-center p-4 relative overflow-hidden`}>

                {/* PartÃ­culas de fundo animadas */}
                <div className="absolute inset-0 pointer-events-none">
                    <div className="absolute top-20 left-20 text-6xl opacity-20 animate-bounce">â­</div>
                    <div className="absolute top-40 right-20 text-4xl opacity-30 animate-pulse">ğŸŒŸ</div>
                    <div className="absolute bottom-40 left-40 text-5xl opacity-15 animate-bounce" style={{animationDelay: '1s'}}>âœ¨</div>
                    <div className="absolute bottom-20 right-40 text-3xl opacity-25 animate-pulse" style={{animationDelay: '2s'}}>ğŸš€</div>
                    <div className="absolute top-1/2 left-1/4 text-4xl opacity-20 animate-bounce" style={{animationDelay: '0.5s'}}>ğŸ”º</div>
                    <div className="absolute top-1/3 right-1/3 text-3xl opacity-25 animate-pulse" style={{animationDelay: '1.5s'}}>â­•</div>
                </div>

                <div className="bg-gradient-to-br from-white via-gray-50 to-white rounded-3xl shadow-2xl p-10 max-w-lg w-full transform transition-all duration-500 hover:scale-105 border-4 border-purple-200 relative z-10">
                    {/* Header Ã©pico */}
                    <div className="text-center mb-10">
                        <div className="relative mb-6">
                            <div className="bg-gradient-to-br from-yellow-300 via-orange-400 to-red-500 rounded-full p-6 shadow-2xl inline-block">
                                <div className="text-7xl animate-pulse">{activityConfig.emoji}</div>
                            </div>
                            <div className="absolute inset-0 bg-gradient-to-r from-yellow-300 via-orange-400 to-red-500 rounded-full opacity-30 animate-ping"></div>
                        </div>
                        <h1 className="text-4xl font-black text-gray-800 mb-4 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 bg-clip-text text-transparent">
                            {activityConfig.title}
                        </h1>
                        <div className="bg-gradient-to-r from-blue-100 via-purple-100 to-pink-100 rounded-2xl p-4 border-2 border-purple-200">
                            <p className="text-xl font-bold text-purple-800">ğŸ¯ Bem-vindo ao Mundo das Formas! ğŸŒŸ</p>
                            <p className="text-lg text-gray-700 mt-2">ğŸ® Explore geometria em jogos, espaÃ§o e esportes! ğŸ†</p>
                        </div>
                    </div>

                    <div className="space-y-8">
                        {/* Input do nome com estilo Ã©pico */}
                        <div className="relative">
                            <label className="block text-xl font-black text-gray-800 mb-4 text-center">
                                <span className="text-3xl mr-2">ğŸ‘¨â€ğŸš€</span>
                                Qual Ã© o nome do nosso explorador espacial?
                                <span className="text-3xl ml-2">ğŸ‘©â€ğŸš€</span>
                            </label>
                            <div className="relative">
                                <input
                                    type="text"
                                    className="w-full px-6 py-4 border-4 border-purple-300 rounded-2xl text-xl text-center focus:outline-none focus:border-purple-500 transition-all duration-300 font-bold bg-gradient-to-r from-blue-50 to-purple-50"
                                    placeholder="âœ¨ Digite seu nome de astronauta âœ¨"
                                    value={studentName}
                                    onChange={(e) => setStudentName(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && studentName.trim() && onStart(studentName)}
                                />
                                {studentName.trim() && (
                                    <div className="absolute right-4 top-1/2 transform -translate-y-1/2 text-2xl animate-bounce">ğŸš€</div>
                                )}
                            </div>
                        </div>

                        {/* ConfiguraÃ§Ã£o de fonte */}
                        <div className="bg-gradient-to-r from-gray-100 to-blue-100 rounded-2xl p-6 border-2 border-gray-300">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-2">
                                    <span className="text-2xl">ğŸ”¤</span>
                                    <span className="text-lg font-bold text-gray-800">Fonte para Dislexia:</span>
                                </div>
                                <button
                                    onClick={() => {
                                        const newFont = font === 'Comic Sans MS' ? 'OpenDyslexic' : 'Comic Sans MS';
                                        setFont(newFont);
                                        localStorage.setItem('selectedFont', newFont === 'OpenDyslexic' ? 'dyslexic' : 'normal');
                                    }}
                                    className={`px-6 py-3 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 ${font === 'OpenDyslexic' ? 'bg-green-500 text-white shadow-lg' : 'bg-gray-300 text-gray-700'}`}
                                >
                                    {font === 'OpenDyslexic' ? 'âœ… Ativada' : 'âšª Desativada'}
                                </button>
                            </div>
                        </div>

                        {/* BotÃµes Ã©picos */}
                        <div className="space-y-4">
                            <button
                                onClick={() => onStart(studentName)}
                                disabled={!studentName.trim()}
                                className={`w-full bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-white font-black py-5 rounded-2xl text-2xl transition-all duration-300 hover:shadow-2xl transform hover:scale-105 border-2 border-white/30 relative overflow-hidden group ${!studentName.trim() ? 'opacity-50 cursor-not-allowed' : ''}`}
                            >
                                <span className="relative z-10 flex items-center justify-center gap-3">
                                    <span className="text-3xl animate-pulse">ğŸ®</span>
                                    INICIAR AVENTURA GEOMÃ‰TRICA
                                    <span className="text-3xl animate-bounce">ğŸŒŸ</span>
                                </span>
                                {studentName.trim() && (
                                    <div className="absolute inset-0 bg-white/10 group-hover:bg-white/20 transition-all animate-pulse"></div>
                                )}
                            </button>

                            <button
                                onClick={() => window.location.href = '../index.html'}
                                className="w-full bg-gradient-to-r from-gray-500 via-gray-600 to-gray-700 text-white font-black py-4 rounded-2xl text-lg transition-all duration-300 hover:shadow-2xl transform hover:scale-105 border-2 border-white/30 relative overflow-hidden group"
                            >
                                <span className="relative z-10 flex items-center justify-center gap-3">
                                    <span className="text-2xl animate-pulse">ğŸ </span>
                                    VOLTAR AO PORTAL PRINCIPAL
                                    <span className="text-2xl animate-bounce">ğŸŒŒ</span>
                                </span>
                                <div className="absolute inset-0 bg-white/10 group-hover:bg-white/20 transition-all"></div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        );

        const BlockSelectionScreen = ({ studentName, onSelectBlock, onFinishSession }) => {
            const [hoveredBlock, setHoveredBlock] = useState(null);

            const groupedLevels = {};
            activityBlocks.forEach(block => {
                if (!groupedLevels[block.difficulty]) groupedLevels[block.difficulty] = [];
                groupedLevels[block.difficulty].push(block);
            });

            return (
                <div className={`min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4`}>

                    {/* Header com animaÃ§Ã£o de partÃ­culas */}
                    <div className="max-w-7xl mx-auto relative">
                        <div className="absolute inset-0 overflow-hidden pointer-events-none">
                            <div className="absolute top-10 left-10 text-6xl opacity-30 animate-bounce">â­</div>
                            <div className="absolute top-20 right-20 text-4xl opacity-40 animate-pulse">ğŸŒŸ</div>
                            <div className="absolute bottom-20 left-20 text-5xl opacity-20 animate-bounce" style={{animationDelay: '1s'}}>âœ¨</div>
                            <div className="absolute top-40 right-40 text-3xl opacity-30 animate-pulse" style={{animationDelay: '2s'}}>ğŸš€</div>
                        </div>

                        <div className="text-center mb-12 relative z-10">
                            <div className="inline-block mb-6">
                                <div className="bg-gradient-to-br from-yellow-300 via-orange-400 to-red-500 rounded-full p-8 shadow-2xl transform animate-pulse">
                                    <div className="text-8xl">ğŸŒŒ</div>
                                </div>
                            </div>
                            <h1 className="text-6xl font-bold text-white mb-4 drop-shadow-2xl">ğŸ‰ OlÃ¡, {studentName}! ğŸ‰</h1>
                            <p className="text-3xl text-yellow-200 font-bold mb-2">Bem-vindo ao Mundo das Formas GeomÃ©tricas!</p>
                            <p className="text-xl text-white opacity-90">âœ¨ Explore formas em jogos, no espaÃ§o e nos esportes! âœ¨</p>
                        </div>
                        
                        {Object.entries(groupedLevels).map(([levelName, blocksInLevel]) => (
                            <div key={levelName} className="mb-16 relative">
                                {/* Header da seÃ§Ã£o com efeito neon */}
                                <div className="bg-black/30 backdrop-blur-sm rounded-3xl p-8 mb-10 border-4 border-white/20 shadow-2xl">
                                    <h2 className="text-5xl font-bold text-center text-white mb-4 drop-shadow-2xl">
                                        <span className="inline-block mr-4 animate-bounce">
                                            {levelName === 'Iniciante' && 'ğŸŒ±'}
                                            {levelName === 'IntermediÃ¡rio' && 'âš¡'}
                                            {levelName === 'AvanÃ§ado' && 'ğŸ”¥'}
                                        </span>
                                        <span className="bg-gradient-to-r from-yellow-300 via-orange-400 to-red-500 bg-clip-text text-transparent">
                                            {levelName === 'Iniciante' && 'AVENTUREIRO DAS FORMAS'}
                                            {levelName === 'IntermediÃ¡rio' && 'MESTRE DA GEOMETRIA'}
                                            {levelName === 'AvanÃ§ado' && 'LENDA GEOMÃ‰TRICA'}
                                        </span>
                                    </h2>
                                    <p className="text-center text-xl text-cyan-200 font-bold">
                                        {levelName === 'Iniciante' && 'ğŸ® Explore formas em jogos, espaÃ§o e esportes!'}
                                        {levelName === 'IntermediÃ¡rio' && 'ğŸ† Domine desafios em mÃºltiplos universos!'}
                                        {levelName === 'AvanÃ§ado' && 'ğŸ‘‘ Conquiste todos os mundos geomÃ©tricos!'}
                                    </p>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                    {blocksInLevel.map((block, index) => (
                                        <div
                                            key={block.id}
                                            className="relative bg-gradient-to-br from-white via-gray-50 to-white rounded-3xl shadow-2xl p-8 transform transition-all duration-500 hover:scale-110 hover:shadow-3xl cursor-pointer group overflow-hidden border-4 border-transparent hover:border-yellow-300"
                                            onClick={() => {
                                                SoundSystem.click();
                                                onSelectBlock(block);
                                            }}
                                            onMouseEnter={() => setHoveredBlock(block.id)}
                                            onMouseLeave={() => setHoveredBlock(null)}
                                            style={{animationDelay: `${index * 0.2}s`}}
                                        >
                                            {/* Efeito de partÃ­culas de fundo */}
                                            <div className="absolute inset-0 opacity-10 group-hover:opacity-20 transition-opacity">
                                                <div className="absolute top-2 right-2 text-2xl animate-pulse">âœ¨</div>
                                                <div className="absolute bottom-2 left-2 text-xl animate-bounce">â­</div>
                                                <div className="absolute top-1/2 right-1/4 text-lg animate-pulse" style={{animationDelay: '1s'}}>ğŸŒŸ</div>
                                            </div>

                                            <div className="text-center relative z-10">
                                                {/* Emoji com efeito especial */}
                                                <div className="relative mb-6">
                                                    <div className={`text-8xl mb-2 transform transition-all duration-500 ${hoveredBlock === block.id ? 'scale-125 animate-bounce' : 'group-hover:scale-110'}`}>
                                                        {block.emoji}
                                                    </div>
                                                    {hoveredBlock === block.id && (
                                                        <div className="absolute inset-0 bg-gradient-to-r from-yellow-300 via-orange-400 to-red-500 rounded-full opacity-30 animate-ping"></div>
                                                    )}
                                                </div>

                                                {/* TÃ­tulo com gradiente animado */}
                                                <h3 className={`text-2xl font-black mb-4 bg-gradient-to-r ${block.color} bg-clip-text text-transparent transform transition-all duration-300 group-hover:scale-105`}>
                                                    {block.title}
                                                </h3>

                                                <p className="text-gray-700 mb-6 text-lg font-semibold leading-relaxed">{block.description}</p>

                                                {/* Info box com efeito neon */}
                                                <div className="bg-gradient-to-r from-blue-100 via-purple-100 to-pink-100 rounded-2xl p-6 mb-6 border-2 border-purple-200 group-hover:border-purple-400 transition-all">
                                                    {block.isQuizMode ? (
                                                        <div className="flex items-center justify-center gap-2">
                                                            <span className="text-2xl">ğŸŒŒ</span>
                                                            <p className="text-lg font-bold text-purple-800">{block.questions.length} QuestÃµes GalÃ¡cticas</p>
                                                        </div>
                                                    ) : (
                                                        <div className="flex items-center justify-center gap-2">
                                                            <span className="text-2xl">ğŸ¯</span>
                                                            <p className="text-lg font-bold text-blue-800">{block.challenge.targets.length} Figuras para Dominar</p>
                                                        </div>
                                                    )}
                                                </div>

                                                {/* BotÃ£o com efeito especial */}
                                                <button className={`w-full bg-gradient-to-r ${block.color} text-white font-black py-5 rounded-2xl text-xl transition-all duration-300 hover:shadow-2xl group-hover:scale-105 transform relative overflow-hidden border-2 border-white/30`}>
                                                    <span className="relative z-10 flex items-center justify-center gap-3">
                                                        <span className="text-2xl animate-pulse">ğŸš€</span>
                                                        INICIAR MISSÃƒO
                                                        <span className="text-2xl animate-bounce">â­</span>
                                                    </span>
                                                    {hoveredBlock === block.id && (
                                                        <div className="absolute inset-0 bg-white/20 animate-pulse"></div>
                                                    )}
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))}

                        {/* Footer Ã©pico */}
                        <div className="bg-gradient-to-br from-black/40 via-purple-900/40 to-black/40 backdrop-blur-lg rounded-3xl p-10 border-4 border-white/20 shadow-2xl">
                            <div className="text-center mb-6">
                                <div className="text-6xl mb-4">ğŸ¯</div>
                                <h3 className="text-3xl font-bold text-white mb-2">Centro de Controle GeomÃ©trico</h3>
                                <p className="text-lg text-cyan-200">Gerencie sua jornada pelos mundos das figuras geomÃ©tricas</p>
                            </div>

                            <div className="flex flex-col md:flex-row gap-6 justify-center">
                                <button
                                    onClick={onFinishSession}
                                    className="bg-gradient-to-r from-green-400 via-green-500 to-green-600 text-white font-black py-5 px-10 rounded-2xl text-xl transition-all duration-300 hover:shadow-2xl transform hover:scale-105 border-2 border-white/30 relative overflow-hidden group"
                                >
                                    <span className="relative z-10 flex items-center justify-center gap-3">
                                        <span className="text-2xl animate-pulse">ğŸ’¾</span>
                                        RELATÃ“RIO DA MISSÃƒO
                                        <span className="text-2xl animate-bounce">ğŸ“Š</span>
                                    </span>
                                    <div className="absolute inset-0 bg-white/10 group-hover:bg-white/20 transition-all"></div>
                                </button>

                                <button
                                    onClick={() => window.location.href = '../index.html'}
                                    className="bg-gradient-to-r from-gray-500 via-gray-600 to-gray-700 text-white font-black py-5 px-10 rounded-2xl text-xl transition-all duration-300 hover:shadow-2xl transform hover:scale-105 border-2 border-white/30 relative overflow-hidden group"
                                >
                                    <span className="relative z-10 flex items-center justify-center gap-3">
                                        <span className="text-2xl animate-pulse">ğŸš€</span>
                                        PORTAL PRINCIPAL
                                        <span className="text-2xl animate-bounce">ğŸ </span>
                                    </span>
                                    <div className="absolute inset-0 bg-white/10 group-hover:bg-white/20 transition-all"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const BlockCompletePopup = ({ stats, onContinue }) => (
            <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 celebration-popup">
                <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-lg w-full text-center transform transition-all duration-500 scale-100">
                    <div className="text-8xl mb-4">ğŸ‰</div>
                    <h2 className="text-4xl font-bold text-gray-800 mb-3">Aventura ConcluÃ­da!</h2>
                    <p className="text-gray-600 text-lg mb-6">VocÃª Ã© um mestre construtor! Veja seu desempenho:</p>
                    <div className="grid grid-cols-3 gap-4 bg-gray-100 rounded-xl p-6 mb-8 text-center">
                        <div>
                            <div className="text-4xl font-bold text-blue-500">{stats.timeSpent}s</div>
                            <div className="text-sm text-gray-600">Tempo</div>
                        </div>
                        <div>
                            <div className="text-4xl font-bold text-green-500">{stats.acertos}</div>
                            <div className="text-sm text-gray-600">Acertos</div>
                        </div>
                        <div>
                            <div className="text-4xl font-bold text-red-500">{stats.erros}</div>
                            <div className="text-sm text-gray-600">Erros</div>
                        </div>
                    </div>
                    <button
                        onClick={onContinue}
                        className="w-full bg-gradient-to-r from-green-500 to-teal-500 text-white font-bold py-4 rounded-xl text-xl transition-all duration-300 hover:shadow-lg transform hover:scale-105"
                    >
                        Continuar Jornada ğŸš€
                    </button>
                </div>
            </div>
        );

        // Componente para Quiz de mÃºltipla escolha
        const QuizScreen = ({ block, onBack, onComplete }) => {
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0)
            const [answers, setAnswers] = useState({})
            const [showFeedback, setShowFeedback] = useState(false)
            const [feedbackMessage, setFeedbackMessage] = useState('')
            const [isCorrectAnswer, setIsCorrectAnswer] = useState(false)
            const [startTime] = useState(Date.now())
            const [totalCorrect, setTotalCorrect] = useState(0)
            const [showBlockCompletePopup, setShowBlockCompletePopup] = useState(false)
            const [blockStats, setBlockStats] = useState(null)
            const [showSpectacularCelebration, setShowSpectacularCelebration] = useState(false)

            const currentQuestion = block.questions[currentQuestionIndex]
            const isLastQuestion = currentQuestionIndex === block.questions.length - 1

            const handleAnswerSelect = (optionId) => {
                if (showFeedback) return

                const isCorrect = optionId === currentQuestion.correct
                setIsCorrectAnswer(isCorrect)
                setAnswers(prev => ({ ...prev, [currentQuestion.id]: { selected: optionId, correct: isCorrect } }))

                if (isCorrect) {
                    SoundSystem.success()
                    setTotalCorrect(prev => prev + 1)
                    setFeedbackMessage(currentQuestion.feedback.correct)
                    setShowSpectacularCelebration(true)
                    setTimeout(() => setShowSpectacularCelebration(false), 2000)
                } else {
                    SoundSystem.error()
                    setFeedbackMessage(currentQuestion.feedback.incorrect)
                }

                setShowFeedback(true)

                setTimeout(() => {
                    if (isLastQuestion) {
                        const timeSpent = Math.round((Date.now() - startTime) / 1000)
                        const stats = {
                            block,
                            questionId: 'quiz_complete',
                            timeSpent,
                            acertos: totalCorrect + (isCorrect ? 1 : 0),
                            erros: block.questions.length - (totalCorrect + (isCorrect ? 1 : 0)),
                            score: Math.round(((totalCorrect + (isCorrect ? 1 : 0)) / block.questions.length) * 100)
                        }
                        onComplete(stats)
                        setBlockStats(stats)
                        setShowBlockCompletePopup(true)
                    } else {
                        setCurrentQuestionIndex(prev => prev + 1)
                        setShowFeedback(false)
                    }
                }, 3000)
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4">
                    {showSpectacularCelebration && (
                        <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 celebration-popup">
                            <div className="bg-gradient-to-br from-yellow-300 via-orange-400 to-red-500 rounded-3xl p-12 text-center max-w-2xl mx-4 shadow-2xl border-4 border-white transform animate-bounce">
                                <div className="text-8xl mb-6">ğŸ‰ğŸŒŸâœ¨</div>
                                <h2 className="text-6xl font-bold text-white mb-4 drop-shadow-lg">INCRÃVEL!</h2>
                                <div className="text-4xl mb-4">ğŸš€ğŸŒŒâ­</div>
                                <p className="text-2xl text-white font-bold drop-shadow">VocÃª estÃ¡ dominando o universo das formas!</p>
                            </div>
                        </div>
                    )}
                    {showBlockCompletePopup && <BlockCompletePopup stats={blockStats} onContinue={onBack} />}

                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white rounded-3xl shadow-2xl p-8 mb-8">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-4xl font-bold text-gray-800 mb-2">{block.emoji} {block.title}</h1>
                                    <p className="text-xl text-gray-600">{block.description}</p>
                                </div>
                                <button onClick={onBack} className="bg-gray-500 text-white px-6 py-3 rounded-xl hover:bg-gray-600 text-lg font-bold">â¬…ï¸ Voltar</button>
                            </div>
                            <div className="w-full bg-gray-200 rounded-full h-6 mb-4">
                                <div className={`bg-gradient-to-r ${block.color} h-6 rounded-full transition-all duration-500 flex items-center justify-center`} style={{ width: `${((currentQuestionIndex + 1) / block.questions.length) * 100}%` }}>
                                    <span className="text-white font-bold text-sm">ğŸš€</span>
                                </div>
                            </div>
                            <div className="text-center font-bold text-gray-700 text-xl">
                                ğŸŒŸ Progresso GalÃ¡ctico: {currentQuestionIndex + 1} de {block.questions.length} | Acertos: {totalCorrect} â­
                            </div>
                        </div>

                        <div className="bg-gradient-to-br from-blue-100 via-purple-100 to-pink-100 rounded-3xl shadow-xl p-8 mb-6 border-4 border-purple-300">
                            <div className="text-center mb-8">
                                <div className="text-6xl mb-4">{currentQuestion.id.includes('1') || currentQuestion.id.includes('2') ? 'ğŸ›¸' : currentQuestion.id.includes('3') || currentQuestion.id.includes('4') ? 'ğŸ’' : currentQuestion.id.includes('5') || currentQuestion.id.includes('6') ? 'ğŸŒ•' : 'âš¡'}</div>
                                <h2 className="text-3xl font-bold text-gray-800 mb-4">{currentQuestion.statement}</h2>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                {currentQuestion.options.map((option) => (
                                    <button
                                        key={option.id}
                                        onClick={() => handleAnswerSelect(option.id)}
                                        disabled={showFeedback}
                                        className={`p-6 rounded-2xl border-4 text-2xl font-bold transition-all duration-300 transform hover:scale-105 ${
                                            showFeedback
                                                ? option.id === currentQuestion.correct
                                                    ? 'bg-green-200 border-green-500 correct-answer-animation'
                                                    : answers[currentQuestion.id]?.selected === option.id
                                                    ? 'bg-red-200 border-red-500 wrong-answer-animation'
                                                    : 'bg-gray-100 border-gray-300'
                                                : 'bg-white border-purple-300 hover:border-purple-500 hover:bg-purple-50 cursor-pointer'
                                        }`}
                                    >
                                        <div className="text-4xl mb-2">{option.text.split(' ')[0]}</div>
                                        <div className="text-lg">{option.text.split(' ').slice(1).join(' ')}</div>
                                    </button>
                                ))}
                            </div>

                            {showFeedback && (
                                <div className={`text-center p-6 rounded-2xl text-2xl font-bold ${isCorrectAnswer ? 'bg-green-200 text-green-800' : 'bg-blue-200 text-blue-800'} border-4 ${isCorrectAnswer ? 'border-green-500' : 'border-blue-500'}`}>
                                    <div className="text-4xl mb-2">{isCorrectAnswer ? 'ğŸ‰' : 'ğŸ’¡'}</div>
                                    {feedbackMessage}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            )
        }

        const ActivityScreen = ({ block, onBack, onComplete }) => {
            // Se o bloco tem questÃµes (Ã© um quiz), usar o QuizScreen
            if (block.isQuizMode && block.questions) {
                return <QuizScreen block={block} onBack={onBack} onComplete={onComplete} />
            }

            // Caso contrÃ¡rio, usar o sistema de arrastar e soltar original
            const [targets, setTargets] = useState(block.challenge.targets.map(t => ({ ...t, isCorrect: false, droppedShape: null })))
            const [figures, setFigures] = useState([...block.challenge.figures].sort(() => Math.random() - 0.5))
            const [draggedItem, setDraggedItem] = useState(null)
            const [startTime, setStartTime] = useState(Date.now())
            const [errors, setErrors] = useState(0)
            const [showCelebration, setShowCelebration] = useState(false)
            const [isCompleted, setIsCompleted] = useState(false)
            const [showBlockCompletePopup, setShowBlockCompletePopup] = useState(false)
            const [blockStats, setBlockStats] = useState(null)

            const correctCount = targets.filter(t => t.isCorrect).length
            const totalCount = targets.length

            const handleDragStart = (e, figure) => {
                setDraggedItem(figure)
                e.dataTransfer.effectAllowed = 'move'
            }

            const handleDragOver = (e) => {
                e.preventDefault()
                e.dataTransfer.dropEffect = 'move'
            }

            const handleDrop = (e, targetId) => {
                e.preventDefault()
                if (!draggedItem) return

                const target = targets.find(t => t.id === targetId)
                if (target.isCorrect) return

                const isCorrect = target.shape === draggedItem
                SoundSystem.click()

                if (isCorrect) {
                    SoundSystem.success()
                    setShowCelebration(true)
                    setTimeout(() => setShowCelebration(false), 1500)
                    setTargets(prev => prev.map(t => 
                        t.id === targetId ? { ...t, isCorrect: true, droppedShape: draggedItem } : t
                    ))
                    setFigures(prev => prev.filter(f => f !== draggedItem))
                } else {
                    SoundSystem.error()
                    setErrors(prev => prev + 1)
                }
                setDraggedItem(null)
            }

            useEffect(() => {
                if (!isCompleted && correctCount === totalCount && totalCount > 0) {
                    setIsCompleted(true)
                    const timeSpent = Math.round((Date.now() - startTime) / 1000)
                    const stats = {
                        block,
                        questionId: block.challenge.id,
                        timeSpent,
                        acertos: totalCount,
                        erros: errors,
                        score: Math.round((totalCount / (totalCount + errors)) * 100)
                    }
                    onComplete(stats)
                    setBlockStats(stats)
                    setShowBlockCompletePopup(true)
                }
            }, [correctCount, totalCount, isCompleted, startTime, onComplete, block, errors])

            return (
                <div className={`min-h-screen bg-gradient-to-br from-blue-400 via-purple-400 to-pink-400 p-4`}>
                    {showCelebration && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 celebration-popup">
                            <div className="bg-white rounded-lg p-8 text-center max-w-md mx-4">
                                <div className="text-4xl mb-4">ğŸ‰</div>
                                <p className="text-2xl font-bold text-green-600 mb-4">Correto!</p>
                            </div>
                        </div>
                    )}
                    {showBlockCompletePopup && <BlockCompletePopup stats={blockStats} onContinue={onBack} />}
                    
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h1 className="text-2xl font-bold text-gray-800">{block.emoji} {block.title}</h1>
                                <button onClick={onBack} className="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">â¬…ï¸ Voltar</button>
                            </div>
                            <div className="w-full bg-gray-200 rounded-full h-4">
                                <div className={`bg-gradient-to-r ${block.color} h-4 rounded-full transition-all duration-500`} style={{ width: `${(correctCount / totalCount) * 100}%` }}></div>
                            </div>
                            <div className="text-center font-bold text-gray-700 mt-2">
                                ğŸ“Š Progresso: {correctCount} de {totalCount} | Erros: {errors}
                            </div>
                        </div>

                        <div className="grid md:grid-cols-2 gap-8">
                            <div className="bg-white/90 backdrop-blur-sm rounded-lg p-6 border-2 border-blue-200">
                                <h3 className="text-2xl font-bold mb-4 text-center">Figuras para Arrastar</h3>
                                <div className="grid grid-cols-2 gap-4">
                                    {figures.map((figure, index) => (
                                        <div
                                            key={index}
                                            draggable
                                            onDragStart={(e) => handleDragStart(e, figure)}
                                            className="bg-yellow-200 border-2 border-yellow-400 rounded-lg p-4 text-center cursor-move hover:bg-yellow-300 transition duration-300 text-xl font-bold"
                                        >
                                            {figure}
                                        </div>
                                    ))}
                                </div>
                            </div>
                          
                            <div className="bg-white/90 backdrop-blur-sm rounded-lg p-6 border-2 border-green-200">
                                <h3 className="text-2xl font-bold mb-4 text-center">Onde Colocar</h3>
                                <div className="space-y-4">
                                    {targets.map((target) => (
                                        <div
                                            key={target.id}
                                            onDragOver={handleDragOver}
                                            onDrop={(e) => handleDrop(e, target.id)}
                                            className={`min-h-[4rem] p-4 border-2 rounded-lg text-center transition duration-300 flex items-center justify-center ${ 
                                                target.isCorrect 
                                                    ? 'bg-green-200 border-green-500 correct-answer-animation' 
                                                    : 'bg-gray-100 border-dashed border-gray-400 hover:bg-gray-200'
                                            }`}
                                        >
                                            {target.isCorrect ? (
                                                <div className="text-green-800 font-bold text-xl">
                                                    âœ“ {target.emoji} {target.name} - {target.droppedShape}
                                                </div>
                                            ) : (
                                                <div className="text-gray-700 text-xl">
                                                   {target.emoji} {target.name}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            )
        }

        const AtividadeTemplate = () => {
            const [studentName, setStudentName] = useState(localStorage.getItem('studentName') || '')
            const [font, setFont] = useState(localStorage.getItem('selectedFont') === 'dyslexic' ? 'OpenDyslexic' : 'Comic Sans MS')
            const [currentScreen, setCurrentScreen] = useState('initial')
            const [selectedBlock, setSelectedBlock] = useState(null)
            const [sessionResults, setSessionResults] = useState([])

            useEffect(() => {
                document.title = activityConfig.title
                document.body.className = font === 'OpenDyslexic' ? 'font-dyslexic' : ''
            }, [font])

            const handleStart = (name) => {
                if (name.trim()) {
                    setStudentName(name)
                    localStorage.setItem('studentName', name)
                    setCurrentScreen('blockSelection')
                }
            }

            const handleSelectBlock = (block) => {
                setSelectedBlock(block)
                setCurrentScreen('activity')
            }
            
            const handleCompleteBlock = (result) => {
                // Determinar o total de questÃµes baseado no tipo de bloco
                const totalQuestions = result.block.isQuizMode
                    ? result.block.questions.length
                    : result.block.challenge.targets.length;

                const newResult = {
                    Nome: studentName,
                    Materia: activityConfig.subject,
                    Atividade: activityConfig.activity,
                    Bloco: result.block.title,
                    Questao: `${result.acertos}_de_${totalQuestions}`,
                    Tempo_Execucao: result.timeSpent + 's',
                    Acertos: result.acertos,
                    Erros: result.erros,
                    Score: result.score + '%'
                }
                setSessionResults(prev => [...prev, newResult])
            }

            const handleFinishSession = () => {
                if (sessionResults.length === 0) {
                    alert("Nenhuma atividade foi completada para gerar o relatÃ³rio.")
                    return
                }
                
                const header = 'Nome,Materia,Atividade,Bloco,Questao,Tempo_Execucao,Acertos,Erros,Score\n'
                const csvContent = sessionResults.map(r => Object.values(r).join(',')).join('\n')
                const fullContent = header + csvContent
                
                const blob = new Blob([fullContent], { type: 'text/csv;charset=utf-8;' })
                const link = document.createElement('a')
                const url = URL.createObjectURL(blob)
                link.href = url
                
                const dateStr = new Date().toLocaleDateString('pt-BR').replace(/\//g, '-')
                const studentNameForFile = studentName.replace(/[^a-zA-Z0-9]/g, '_')
                link.download = `${activityConfig.activity}_${studentNameForFile}_${dateStr}.csv`
                
                document.body.appendChild(link)
                link.click()
                document.body.removeChild(link)
                URL.revokeObjectURL(url)

                alert(`ğŸ‰ Dados exportados com sucesso!`);
            }

            switch (currentScreen) {
                case 'initial':
                    return <InitialScreen onStart={handleStart} studentName={studentName} setStudentName={setStudentName} font={font} setFont={setFont} />
                case 'blockSelection':
                    return <BlockSelectionScreen studentName={studentName} onSelectBlock={handleSelectBlock} onFinishSession={handleFinishSession} />
                case 'activity':
                    return <ActivityScreen block={selectedBlock} onBack={() => setCurrentScreen('blockSelection')} onComplete={handleCompleteBlock} />
                default:
                    return <InitialScreen onStart={handleStart} studentName={studentName} setStudentName={setStudentName} font={font} setFont={setFont} />
            }
        };

        ReactDOM.render(<AtividadeTemplate />, document.getElementById('root'));
    </script>
</body>
</html>
